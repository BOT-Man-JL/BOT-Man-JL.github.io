<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width">
    <title class="articlesTitleSec">Loading...</title>
    <link rel="stylesheet" href="/stylesheets/github-markdown.css">
    <link rel="stylesheet" href="/stylesheets/bot-frame.css">
    <!-- Math Support -->
    <link rel="stylesheet" href="/stylesheets/katex.min.css">
</head>
<body>
    <div class="wrapper">
        <header>
            <nav class="navSec"></nav>
            <div class="contactSec"></div>
            <div class="headerTitleSec"></div>
            <div class="headerQuoteSec"></div>
        </header>
        <section class="markdown-body">
            <div class="promptSec"></div>
            <div class="archiveSec"></div>
            <div class="contentSec"></div>
            <div class="commentSec"></div>
            <div class="gotoTopSec"><a href="#">TOP ⬆️</a></div>
        </section>
        <footer class="footerSec"></footer>
    </div>
    <script src="/javascripts/marked.js"></script>
    <script src="/javascripts/bot-frame.js"></script>
    <!-- Math Support -->
    <script src="/javascripts/katex.min.js"></script>
    <script src="/javascripts/auto-render.min.js"></script>
    <script>
        var post = GetSearchParam(location.search, "post");
        if (post != null) {
            RenderSectionWithPrompt("/assets.md", "promptSec",
                [
                    "navSec",
                    "footerSec"
                ], function () {
                    RenderSectionWithPrompt(post + ".md",
                        "promptSec", "contentSec", function () {
                            var contentSec =
                                document.getElementsByClassName("contentSec")[0];

                            // Move elements to left pane
                            document.title = MoveFirstElement(
                                document.getElementsByClassName("headerTitleSec")[0],
                                contentSec);
                            MoveFirstElement(
                                document.getElementsByClassName("headerQuoteSec")[0],
                                contentSec);

                            // Styles
                            var stylesStr = GetSearchParam(location.search, "style");
                            var styles = stylesStr != null ? stylesStr.split(',') : [];

                            var isWordMargin = false;
                            var isSlideMode = false;

                            for (var i = 0; i < styles.length; i++) {
                                var style = styles[i];
                                if (style == "cover") {
                                    // TODO: slide-cover
                                    document.getElementsByClassName("headerTitleSec")[0].classList.add('cover-title');
                                    document.getElementsByClassName("headerQuoteSec")[0].classList.add('cover-subtitle');
                                    document.getElementsByTagName("header")[0].style.pageBreakAfter = "always";
                                }
                                else if (style == "word") isWordMargin = true;
                                else if (style == "slide") isSlideMode = true;
                            }

                            var styleElem = document.createElement('style');
                            if (isWordMargin)
                                styleElem.innerHTML += "@page { margin: 25.4mm 31.8mm; }";
                            else
                                styleElem.innerHTML += "@page { margin: 15mm 15mm; }";
                            if (isSlideMode)
                                styleElem.innerHTML += "@page { size: 297mm 210mm; }";
                            else
                                styleElem.innerHTML += "@page { size: 210mm 297mm; }";
                            document.head.appendChild(styleElem);

                            // Render math
                            renderMathInElement(contentSec, {
                                delimiters: [
                                    { left: "$$", right: "$$", display: true },
                                    { left: "\\[", right: "\\]", display: true },
                                    { left: "$", right: "$", display: false },
                                    { left: "\\(", right: "\\)", display: false }
                                ],
                                ignoredTags: [
                                    "script", "noscript", "style", "textarea", "pre", "code"
                                ]
                            });
                        });
                });

            // Remove Comment currently
            //var comment = document.getElementsByClassName("commentSec")[0];
            //comment.innerHTML = "<h1>Comment Section - Loading ...</h1>";
            //LoadIssues("BOT-Man-JL/BOT-Man-JL.github.io", function (issuesHTML) {
            //    if (issuesHTML == null)
            //        comment.innerHTML = "<h1>Comment Section - Loading Failed :-(</h1>";
            //    else
            //        comment.innerHTML = "<h1>Comment Section</h1>" + issuesHTML;
            //});
        }
        else {
            // Compatible with legacy routing
            if (location.hash != null && location.hash.length > 1)
                location = "./?post=" + location.hash.substr(1);

            RenderSectionWithPrompt("/assets.md", "promptSec",
                [
                    "navSec",
                    "footerSec",
                    "contactSec",
                    { tagName: "articlesTitleSec", isMd: false }
                ], function () {
                    RenderSectionWithPrompt("archive.md", "promptSec",
                        [
                            {
                                tagName: "archiveSec",
                                fixStyle: function (absPath, relPath) {
                                    return "./?post=" + relPath;
                                }
                            }
                        ])
                });
        }
    </script>
</body>
</html>
